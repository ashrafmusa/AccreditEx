# UserAvatar Component Documentation

## Overview
`UserAvatar` is a centralized, reusable component for displaying user profile pictures with intelligent fallback to user initials. It provides a consistent avatar display across the entire application with support for multiple sizes, loading states, and accessibility features.

## Features

✅ **Image Display**: Shows user's uploaded avatar image when available
✅ **Initials Fallback**: Displays user initials if no image is available
✅ **Consistent Colors**: Uses deterministic color generation based on user ID for visual distinction
✅ **Multiple Sizes**: 6 size variants (xs, sm, md, lg, xl, xxl)
✅ **Loading States**: Skeleton/fade-in animation while image loads
✅ **Status Indicator**: Optional status badge showing user online/active status
✅ **Keyboard Accessible**: Full keyboard navigation and ARIA labels
✅ **Dark Mode Support**: Seamless dark/light mode switching
✅ **Error Handling**: Graceful fallback if image fails to load

## Installation

The component is located at: `src/components/common/UserAvatar.tsx`

Import it in your components:

```tsx
import UserAvatar from '@/components/common/UserAvatar';
```

## Usage

### Basic Usage
```tsx
import UserAvatar from '@/components/common/UserAvatar';
import { useUserStore } from '@/stores/useUserStore';

function MyComponent() {
  const currentUser = useUserStore(state => state.currentUser);
  
  return <UserAvatar user={currentUser} size="md" />;
}
```

### With Status Indicator
```tsx
<UserAvatar 
  user={user} 
  size="lg" 
  showStatus 
  ariaLabel={`${user.name} avatar`}
/>
```

### As Clickable Button
```tsx
<UserAvatar 
  user={user} 
  size="xl" 
  onClick={() => navigateToProfile(user.id)}
  ariaLabel={`Open ${user.name} profile`}
/>
```

### In a List
```tsx
{users.map(user => (
  <UserAvatar 
    key={user.id} 
    user={user} 
    size="sm" 
    ariaLabel={user.name}
  />
))}
```

## Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `user` | `User \| null` | (required) | User object containing name, id, and optional avatarUrl |
| `size` | `'xs' \| 'sm' \| 'md' \| 'lg' \| 'xl' \| 'xxl'` | `'md'` | Avatar size variant |
| `showStatus` | `boolean` | `false` | Show online/active status badge |
| `className` | `string` | `''` | Additional CSS classes |
| `onClick` | `() => void` | `undefined` | Click handler to make avatar interactive |
| `ariaLabel` | `string` | `'User avatar'` | Accessibility label for screen readers |

## Size Variants

| Size | Dimensions | Use Case |
|------|-----------|----------|
| `xs` | 24px (w-6 h-6) | Compact lists, comments, notifications |
| `sm` | 32px (w-8 h-8) | User tables, message lists, sidebar |
| `md` | 40px (w-10 h-10) | Default, navigation menus, cards |
| `lg` | 48px (w-12 h-12) | Profile sections, comments |
| `xl` | 64px (w-16 h-16) | Profile header, large displays |
| `xxl` | 96px (w-24 h-24) | Hero sections, detailed profiles |

## Color Scheme

Avatar backgrounds use a deterministic color palette of 12 colors generated from user ID:

- Blue `#3B82F6`
- Red `#EF4444`
- Green `#10B981`
- Amber `#F59E0B`
- Purple `#8B5CF6`
- Pink `#EC4899`
- Cyan `#06B6D4`
- Indigo `#6366F1`
- Teal `#14B8A6`
- Orange `#F97316`
- Gray `#6B7280`
- Fuchsia `#D946EF`

Each user always gets the same color for visual consistency across the app.

## Utility Functions

### `getInitials(name: string, maxChars?: number): string`
Generates user initials from their name, handling edge cases:

```tsx
import { getInitials } from '@/utils/getInitials';

getInitials('John Doe');        // "JD"
getInitials('Abd El-Rahman');   // "AR"
getInitials('Muhammad');         // "MU"
getInitials('Jean-Pierre');      // "JP"
```

### `getAvatarColor(userId: string, userName?: string): string`
Returns consistent color for user based on ID or name:

```tsx
import { getAvatarColor } from '@/utils/getAvatarColor';

const bgColor = getAvatarColor(user.id, user.name);
// Returns hex color: "#3B82F6"
```

## Fallback Behavior

1. **Image Available**: Displays user's `avatarUrl` with fade-in animation
2. **Image Unavailable**: Shows initials on colored background
3. **Image Failed to Load**: Falls back to initials automatically
4. **No User**: Shows empty gray circle

## Loading States

When an image is loading:
- Skeleton overlay appears over preview
- Opacity transitions to show load progress
- Smooth fade-in once image loads

## Accessibility

- Full keyboard navigation support (Tab, Enter, Arrow keys)
- Proper ARIA labels for screen readers
- Role attributes for semantic HTML
- Focus states with visible indicators
- High contrast support via dark mode

## Implementation Examples

### In User Menu (Top Navigation)
```tsx
// src/components/common/UserMenu.tsx
<UserAvatar user={currentUser} size="md" ariaLabel={`${currentUser.name} profile`} />
```

### In User Table (Settings)
```tsx
// src/components/users/UserRow.tsx
<div className="flex items-center gap-3">
  <UserAvatar user={user} size="sm" ariaLabel={`${user.name} avatar`} />
  <div className="font-semibold">{user.name}</div>
</div>
```

### In Project Card (Team Members)
```tsx
// src/components/projects/ProjectCard.tsx
<div className="flex -space-x-2">
  {project.teamMembers.slice(0, 4).map(member => (
    <UserAvatar key={member.id} user={member} size="sm" />
  ))}
  {project.teamMembers.length > 4 && (
    <div className="w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-xs font-bold">
      +{project.teamMembers.length - 4}
    </div>
  )}
</div>
```

### In Messages (Message Bubbles)
```tsx
// src/components/messaging/MessageBubble.tsx
{showAvatar && (
  <div className="flex-shrink-0">
    <UserAvatar user={sender} size="sm" ariaLabel={`${sender.name} avatar`} />
  </div>
)}
```

### In Profile Header
```tsx
// src/components/users/UserProfileHeader.tsx
<UserAvatar 
  user={user} 
  size="xl" 
  showStatus 
  ariaLabel={`${user.name} profile picture`}
/>
```

## Related Components

- **ImageUpload.tsx**: For uploading/updating avatar images
- **ProfileSettingsPage.tsx**: User profile management interface
- **UserMenu.tsx**: Navigation menu with user avatar
- **UserProfileHeader.tsx**: User profile header display

## Best Practices

1. **Always Provide User Object**: Never pass null without handling in parent
2. **Use Appropriate Size**: Choose size based on context and layout
3. **Add Aria Labels**: Always include descriptive ariaLabel for accessibility
4. **Avoid Hardcoding Colors**: Let getAvatarColor handle color generation
5. **Handle Click Handlers**: Provide onClick for interactive avatars
6. **Test Fallbacks**: Test both image and initials display paths

## Future Enhancements

- [ ] Image cropping capability
- [ ] Avatar history/gallery view
- [ ] Custom color selection
- [ ] Animated emoji fallback
- [ ] Badge variations (online, offline, away, dnd)
- [ ] Avatar frame/border options
